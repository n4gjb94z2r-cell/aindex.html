<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>fvde-aruf-webhook</title>
<style>
body { font-family: sans-serif; background: #121212; color: #fff; padding: 20px; }
input, textarea, button { margin: 5px 0; width: 100%; }
button { width: auto; }
</style>
</head>
<body>
<h1>fvde-aruf-webhook</h1>

<label>Webhook URL:</label>
<input type="text" id="webhookUrl" placeholder="https://discord.com/api/webhooks/...">

<label>送信内容:</label>
<textarea id="message" rows="4" placeholder="メッセージを入力"></textarea>

<label>送信回数 (0で無限):</label>
<input type="number" id="count" value="0" min="0">

<label>送信間隔 (秒):</label>
<input type="number" id="interval" value="1" min="0.1" step="0.1">

<button id="startBtn">送信開始</button>
<button id="stopBtn">送信停止</button>

<script>
let intervalId;
let sentCount = 0;

document.getElementById("startBtn").onclick = () => {
    const url = document.getElementById("webhookUrl").value;
    const message = document.getElementById("message").value;
    const count = parseInt(document.getElementById("count").value);
    const intervalSec = parseFloat(document.getElementById("interval").value) * 1000;

    if (!url || !message) {
        alert("Webhook URLとメッセージは必須です。");
        return;
    }

    sentCount = 0;

    intervalId = setInterval(() => {
        fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ content: message })
        }).then(res => console.log("送信成功:", res.status))
          .catch(err => console.error("送信失敗:", err));

        sentCount++;
        if (count > 0 && sentCount >= count) {
            clearInterval(intervalId);
            console.log("指定回数送信完了");
        }
    }, intervalSec);
};

document.getElementById("stopBtn").onclick = () => {
    clearInterval(intervalId);
    console.log("送信停止");
};
</script>
</body>
</html>
